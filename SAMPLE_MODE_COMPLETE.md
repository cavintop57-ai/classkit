# 🎮 샘플 모드 완전 가이드

## ✅ 완성된 기능

### 1. 📱 모바일 앱 (샘플 모드)
- ✅ 세션 코드로 입장
- ✅ 샘플 문제 자동 로드 (5가지)
- ✅ 로컬 정답 체크
- ✅ 메시지 작성 및 전송
- ✅ WebSocket으로 위젯에 실시간 전송

### 2. 💻 위젯 (데스크톱)
- ✅ WebSocket 연결 대기
- ✅ 학생 메시지 수신
- ✅ 아바타에 말풍선 표시
- ✅ 화면 알림 표시

## 🔄 완전한 학습 사이클

### 학생 (모바일)
```
1️⃣ 세션 입장
   📱 http://localhost:8000/W38394
   🔢 코드: W38394
   🚀 입장하기

2️⃣ 문제 풀이
   📚 샘플 문제 로드
   예: "매우 기쁘고 즐거운 마음"
   ✏️ 정답 입력: "환희"
   ✅ 정답입니다!

3️⃣ 메시지 작성
   👤 닉네임: "김철수"
   👾 아바타: 빨강 Among Us
   💬 메시지: "문제 재미있어요!"
   📤 WebSocket으로 전송

4️⃣ 완료
   🎉 메시지가 전송되었습니다!
```

### 선생님 (위젯)
```
1️⃣ 세션 생성
   🏷️ 코드: W38394
   📱 QR 코드 표시
   🔌 WebSocket 대기

2️⃣ 학생 메시지 수신
   📨 WebSocket 메시지 도착
   {
     event: "newMessage",
     payload: {
       nickname: "김철수",
       avatar_id: 0,
       content: "문제 재미있어요!"
     }
   }

3️⃣ 화면 표시
   👾 빨강 Among Us 캐릭터
   💬 말풍선: "문제 재미있어요!"
   ⏱️ 5초간 표시
   
4️⃣ 알림
   📢 우측 상단 알림
   "김철수: 문제 재미있어요!"
```

## 🔌 WebSocket 통신 구조

```
모바일 앱                    백엔드                     위젯
   |                          |                         |
   | 1. 메시지 작성            |                         |
   |    "문제 재미있어요!"      |                         |
   |                          |                         |
   | 2. WebSocket 연결        |                         |
   |------------------------->|                         |
   |    ws://localhost:8000   |                         |
   |                          |                         |
   | 3. 메시지 전송            |                         |
   |    JSON: {               |                         |
   |      event: "newMessage" |                         |
   |      payload: { ... }    |                         |
   |    }                     |                         |
   |------------------------->|                         |
   |                          |                         |
   |                          | 4. 브로드캐스트          |
   |                          |------------------------>|
   |                          |    같은 세션의          |
   |                          |    모든 연결로 전송      |
   |                          |                         |
   |                          |                         | 5. 메시지 처리
   |                          |                         |    - 아바타 찾기
   |                          |                         |    - 말풍선 표시
   |                          |                         |    - 알림 표시
```

## 🎯 테스트 시나리오

### 시나리오 1: 기본 플로우
```
1. 위젯 실행 (http://localhost:5173)
   → 세션 코드 생성: W38394
   → WebSocket 대기 중

2. 모바일 접속 (http://localhost:8000/W38394)
   → 코드 입력: W38394
   → 입장하기

3. 문제 풀기
   → 문제: "happy의 반대말은?"
   → 정답: "sad"
   → ✅ 정답!

4. 메시지 보내기
   → 닉네임: "김철수"
   → 메시지: "선생님 안녕하세요!"
   → 전송

5. 위젯 확인
   → 👾 빨강 캐릭터 등장
   → 💬 "선생님 안녕하세요!" 말풍선
   → 📢 우측 알림 표시
```

### 시나리오 2: 여러 학생
```
학생 1 (빨강): "문제가 쉬워요!"
학생 2 (파랑): "재미있어요!"
학생 3 (초록): "다음 문제 주세요!"

→ 위젯에 3개의 캐릭터 + 말풍선 표시
→ 알림이 순서대로 나타남
```

## 📊 콘솔 로그

### 모바일 콘솔:
```
📱 모바일 앱 시작
✅ 세션 입장: { code: "W38394", ... }
⚠️ API 문제 로드 실패, 샘플 문제 사용
📚 문제 로드 (샘플): { question: "happy의 반대말은?", ... }
📝 샘플 문제 로컬 체크: { answer: "sad", correct: "sad" }
✅ 정답! (샘플 문제)
📝 샘플 모드 메시지 전송 (로컬): { nickname: "김철수", content: "선생님 안녕하세요!" }
📤 위젯으로 메시지 전송: { event: "newMessage", ... }
```

### 위젯 콘솔:
```
🚀 Among Us 캐릭터 생성 준비 완료
🌌 우주 배경 시스템 초기화
✅ 우주 배경 로드 완료 (Among Us 스타일)
🔌 WebSocket 연결 중: ws://localhost:8000/ws/W38394
✅ WebSocket 연결 성공!
📨 WebSocket 메시지: { event: "newMessage", payload: { ... } }
💬 김철수: 선생님 안녕하세요!
```

## 🎨 시각적 효과

### 위젯 화면:
```
🌌 우주 배경
  ⭐ ✨ 별들이 반짝임
  🪐 행성이 천천히 회전
  
👾 Among Us 캐릭터들
  🔴 김철수
     💬 "선생님 안녕하세요!"
     
  🔵 이영희
     💬 "문제가 재미있어요!"
     
  🟢 박민준
     💬 "다음 문제 주세요!"

📢 우측 상단 알림
  ┌─────────────────────┐
  │ 김철수:             │
  │ 선생님 안녕하세요!   │
  └─────────────────────┘
```

## ⚡ 성능 최적화

### WebSocket 최적화
```javascript
// 자동 재연결
reconnectDelay: 3000ms
maxReconnectAttempts: 5

// 메시지 큐잉 (연결 끊김 시)
// 재연결 후 전송
```

### 말풍선 관리
```javascript
// 자동 제거
duration: 5000ms (5초)

// 최대 개수 제한
maxBubbles: 10개
```

## 🎯 완성도

| 기능 | 상태 | 비고 |
|------|------|------|
| 세션 생성 | ✅ | 위젯에서 자동 생성 |
| 세션 입장 | ✅ | 모바일에서 코드 입력 |
| 문제 로드 | ✅ | 샘플 5개 자동 순환 |
| 정답 체크 | ✅ | 로컬에서 즉시 확인 |
| 메시지 작성 | ✅ | 닉네임 + 내용 |
| 메시지 전송 | ✅ | WebSocket 실시간 |
| 위젯 수신 | ✅ | 말풍선 + 알림 표시 |
| 캐릭터 생성 | ✅ | Among Us 12색상 |
| 우주 배경 | ✅ | 별 + 행성 + 먼지 |

## 🎊 완성!

이제 API 서버 없이도:
- 📱 모바일: 문제 풀고 메시지 전송
- 💻 위젯: 실시간으로 메시지 수신 및 표시
- 🔄 양방향 실시간 소통 완벽 작동

**완전한 우주 교실 학습 환경이 완성되었습니다!** 🚀✨

