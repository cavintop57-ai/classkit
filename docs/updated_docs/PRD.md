# 교실 전자칠판 위젯 ‑ PRD
**버전**: 0.3  **작성일**: 2025-10-12  **수정일**: 2025-10-12
## 1. 개요
로컬 PC에서 자동 실행되는 전자칠판 '교실 위젯'과 외부 클라우드 백엔드를 결합하여, 학습 콘텐츠(영단어·속담·오늘의 문제) 표시 + 학생 참여(아바타·말풍선)를 지원한다.
QR 코드로 모바일 페이지에 접속한 학생은 '오늘의 문제' 정답을 입력해야 메시지를 남길 수 있다.

## 2. 목표
* 쉬는 시간 틈새 학습 ↑
* 학습 참여 동기 부여(퀴즈+칭찬)
* 교사 업무 편의(원‑클릭 업무 모드)
* **저사양 PC 안정적 동작** (Pentium J4205급)

## 3. 대상 사용자
| 구분 | 주요 요구 |
|------|-----------|
| 교사 | 자동 실행, 업무 모드 토글, 문제·타이머 제어 |
| 학생 | QR 접속, 아바타 설정, 메시지 전송 |
| 관리자(선택) | 학교·반 관리, 금칙어 관리, 통계 조회 |

## 4. 기능 요구사항 (MVP)

> **저사양 고려**: WebGL·3D 효과는 사용하지 않고, Canvas 2D 또는 SVG 기반의 단순 애니메이션만 사용한다. Electron 렌더러에서 `hardwareAcceleration: false` 설정으로도 정상 동작해야 한다.
1. **세션 코드** 자동 발행(8자리)·화면 표시  
2. **학습 카드** 순환: 영단어/속담/문제  
3. **문제 정답 검증** 후에만 메시지 전송 허용  
4. **도트 아바타 (정지 이미지, 간단한 fade 애니메이션)** + 말풍선 애니메이션 표시 (최대 5개 동시 표시)  
5. **업무 모드**: 학생 레이어·광고 숨김, 타이머 확대  
6. **QR 코드** 자동 갱신(세션 변경 시)  
7. **광고(NPA)** 모바일 페이지 하단 배치  
8. **자동 실행 & 자동 업데이트** (Windows)
9. **저사양 모드**: 애니메이션 품질 자동 조절

## 5. 비기능 요구사항
| 항목 | 목표 |
|------|------|
| 성능 | 60 FPS(일반), 30 FPS(저사양 모드), CPU < 15 % idle @ Pentium J4205 |
| 메모리 | < 200 MB (Electron) 또는 < 100 MB (Tauri 옵션) |
| 보안 | HTTPS, 세션코드 TTL 30 min, XSS 필터, Rate limiting (10 req/min/IP) |
| 가용성 | 백엔드 Uptime ≥ 99 % (Load balancer + 다중 인스턴스 권장) |
| 개인정보 | Login 불필요, 닉네임·반 정보만 수집, 메시지 30일 후 자동 삭제 |
| 확장성 | 동시 활성 세션 100개, 세션당 최대 50명 지원 |

## 6. 시스템 아키텍처
```
[Electron/Tauri 위젯] ⇆ (WebSocket) ⇆ [FastAPI Server] ⇆ [PostgreSQL]
                                     ⇡ REST              ⇅
                             [Mobile PWA / QR]        [Redis]
```

**기술 스택 옵션:**
- **Frontend 위젯**: Electron (권장) 또는 Tauri (저사양 PC 최적화)
- **Backend**: FastAPI + uvicorn
- **Database**: PostgreSQL 16+
- **Cache/Session**: Redis (WebSocket 세션 관리)

## 7. 성능 최적화 전략
### 7.1 저사양 PC 대응
- **Hardware Acceleration** 활성화 (Chromium flags)
- **말풍선 동시 표시 제한**: 최대 5개, 초과 시 FIFO 방식 페이드아웃
- **애니메이션 프레임 조절**: CPU 사용률 20% 초과 시 자동으로 30 FPS 전환
- **메모리 관리**: 1시간마다 WebSocket 연결 재설정, 이미지 캐시 제한

### 7.2 렌더링 최적화
- CSS `transform` + `will-change` 속성 사용 (GPU 가속)
- Canvas 대신 DOM 기반 애니메이션 (저사양 모드)
- 아바타 스프라이트 시트 활용 (개별 이미지 로드 최소화)

## 8. 성공 지표
* 참여 학생 비율 ≥ 70 %
* 평균 일 메시지 수 ≥ 3 건/인
* 서버 오류율 < 0.1 %
* **위젯 평균 CPU 사용률 < 15 %** (Pentium J4205)
* **위젯 평균 메모리 사용량 < 200 MB**

## 9. 일정 (수정)
| 주차 | 마일스톤 |
|------|-----------|
| 1 | UI 와이어프레임 · 기술 PoC (Electron vs Tauri) |
| 2 | WebSocket · 세션 코드 · 학습 카드 |
| 3 | 모바일 PWA · 정답 검증 · Rate limiting |
| 4-5 | 아바타 애니메이션 · 성능 최적화 |
| 6 | 업무 모드 · 저사양 모드 자동 감지 |
| 7 | 광고 삽입 · 자동 업데이트 |
| 8 | 통합 테스트 · 배포 스크립트 |

**총 예상 기간: 8주** (풀타임 개발자 1명 기준)

## 10. 위험 관리
| 위험 요소 | 대응 방안 |
|----------|-----------|
| 저사양 PC 성능 부족 | Tauri 전환, 애니메이션 품질 옵션, 실시간 성능 모니터링 |
| 동시 접속자 폭증 | Redis Pub/Sub, Load balancer, 수평 확장 |
| 금칙어 필터 우회 | 한글 자모 분리 감지, 교사 승인 워크플로우 |
| 광고 정책 위반 | NPA 모드 강제, COPPA 준수, 교육 콘텐츠 제휴 광고 |
